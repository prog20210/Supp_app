<@Page Language="C#">
    @using System.Web.UI.HtmlControls;

    @using System;
    @using System.Collections.Generic;
    @using System.Linq;
    @using System.Web;
    @using System.Web.UI;
    @using System.Web.UI.WebControls;
    @using System.Configuration;
    @using System.Data.SqlClient;
    @using Npgsql;
    @using Npgsql.EntityFrameworkCore.PostgreSQL.Design;
    @using System.Configuration;
    @using System.Web.UI.HtmlControls;
    @using System.Data;
    @using System.Web.Mvc.Html;
    @using ClosedXML
    @using Aspose.Html



    <select id="BorderSelect"
            runat="server">

        <option value="0">0</option>
        <option value="1" selected="selected">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>

    </select>





    @{


        Layout = null;
        int i;
        int n = 0;
        string html;
        int nz = 0;
        string dat = "";
        string year;
        string[] dt;
        string[] tim;
        string t1;
        StringWriter sw = new StringWriter();
        DateTime dt1;

        dt1 = DateTime.Now;

        t1 = dt1.ToString();

        tim = t1.Split(' ');

        dat = dt1.ToShortDateString();


        for (i = 1; i < 60; i++)
        {
            n = i;

        }
        int t = 0;
        int j = 3;

        var tab1 = new HtmlTable();


        ConnectionStringSettings constr;
        constr = ConfigurationManager.ConnectionStrings["con"];


        NpgsqlConnection con = new NpgsqlConnection();


        con.ConnectionString = constr.ToString();

        //"Server = 127.0.0.1; Port = 5433; Database = sup; User Id = postgres; Password =12345";



        con.Open();
        int num;
        int numbn;
        NpgsqlCommand com = con.CreateCommand();
        com.CommandText = "select * from req";

        try
        {


            com.CommandText = "select COUNT(*) from req";

            nz = Convert.ToInt16(com.ExecuteScalar());

            com.CommandText = "select * from req";

            NpgsqlDataReader rd = com.ExecuteReader();

            // Доработать цикл чтения и заполнения таблицы
            if (rd.HasRows)
            {
                


            while (rd.Read())
                {



                }
            }

        }

        catch
        {

        }




        using (sw)
        {




        }


    }



    <body>
        <div>
            <link rel="stylesheet" href="main.css">

            <h2 align="center">Список обращений на @dat г. </h2>




            <table name="html" class="table table-bordered  table-hover">
                <thead>
                <td>
                    <p align="center"> Дата </p>

                </td>

                <td>
                    <p align="center"> Время </p>
                </td>

                <td>
                    <p align="center"> Год </p>
                </td>

                <td>
                    <p align="center"> ФИО</p>
                </td>

                <td>
                    <p align="center"> Подразделение</p>
                </td>

                <td>
                    <p align="center"> Краткое описание</p>
                </td>


                <td>
                    <p align="center"> Статус обращения </p>


                </td>
                </thead>

                <tbody>







                    @{
                        //добавление в тело таблицы







                        /////////////////////////////////////
                        for (i = 0; i <= nz; i++)
                        {


                            // цикл по строкам
                            for (int h = 1; h <= 6; h++)  //nz- к-во строк
                            {
                                <tr>
                                    <td align="center">

                                        @dat

                                    </td>

                                    <td align="center">

                                        @tim[i]

                                    </td>

                                    <td align="center">
                                        @{

                                            dt = @dat.Split('.');

                                            year = dt[2];


                                        }

                                        @year

                                    </td>




                                    <td align="center">

                                        j

                                    </td>


                                    <td align="center">

                                        pppppppppppppppppp

                                    </td>



                                    <td align="center">

                                        ghghghhghhhjjjjikk

                                    </td>





                                    <td align="center">

                                        stob

                                    </td>









                                </tr>




                            }


                        }
                    }

                </tbody>


            </table>



















            <table name="html" class="table table-bordered  table-hover">



                <p align="center"> <button> Выгрузить отчет </button> </p>


        </div>



    </body>
    </html>
